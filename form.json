{
  "$schema": "<relative path to createFormUI.schema.json>",
  "view": {
    "kind": "Form",
    "properties": {
      "title": "A Simple Form",
      "steps": [
        {
          "name": "basics",
          "label": "Basics",
          "elements": [
            {
              "name": "basicsDescriptionTextBlock",
              "type": "Microsoft.Common.TextBlock",
              "options": {
                "text": "This is a simple form deploys a resource group.",
                "link": {
                  "label": "https://github.com/glennmusa/simple-portal-form",
                  "uri": "https://github.com/glennmusa/simple-portal-form"
                }
              }
            },
            {
              "name": "deploymentDetails",
              "label": "Create a Storage Account in a Resource Group",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "subscriptionApi",
                  "type": "Microsoft.Solutions.ArmApiControl",
                  "request": {
                    "method": "GET",
                    "path": "subscriptions?api-version=2020-01-01"
                  }
                },
                {
                  "name": "subscriptionId",
                  "label": "Subscription A",
                  "type": "Microsoft.Common.DropDown",
                  "defaultValue": "",
                  "toolTip": "Select the Subscription for your resources",
                  "multiselect": false,
                  "selectAll": false,
                  "filter": true,
                  "filterPlaceholder": "Filter items ...",
                  "multiLine": true,
                  "constraints": {
                    "allowedValues": "[map(steps('basics').deploymentDetails.subscriptionApi.value, (item) => parse(concat('{\"label\":\"', item.displayName, '\",\"value\":\"', item.id, '\",\"description\":\"', 'ID: ', item.subscriptionId, '\"}')))]",
                    "required": true
                  }
                },
                {
                  "name": "locationsApi",
                  "type": "Microsoft.Solutions.ArmApiControl",
                  "request": {
                    "method": "GET",
                    "path": "locations?api-version=2019-11-01"
                  }
                },
                {
                  "name": "locationName",
                  "label": "Location",
                  "type": "Microsoft.Common.DropDown",
                  "visible": true,
                  "defaultValue": "",
                  "toolTip": "Select the Location for your Data Landing Zone.",
                  "multiselect": false,
                  "selectAll": false,
                  "filter": true,
                  "filterPlaceholder": "Filter items ...",
                  "multiLine": true,
                  "constraints": {
                    "allowedValues": "[map(filter(steps('basics').deploymentDetails.locationsApi.value,(item) => contains(split('southafricanorth,southeastasia,japaneast,canadacentral,northeurope,westeurope,francecentral,germanywestcentral,uksouth,centralus,eastus,eastus2,southcentralus,westus2', ','), item.name)),(item) => parse(concat('{\"label\":\"', item.regionalDisplayName, '\",\"value\":\"', item.name, '\"}')))]",
                    "required": true
                  }
                }
              ]
            },
            {
              "name": "resourceGroupSection",
              "label": "Resource Group",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "resourceGroupNameA",
                  "label": "Resource Group Name A",
                  "type": "Microsoft.Common.TextBox",
                  "defaultValue": "",
                  "toolTip": "Specify a resource group name to create",
                  "constraints": {
                    "required": true,
                    "validations": [
                      {
                        "regex": "^[-\\w\\._\\(\\)]{3,63}$",
                        "message": "The resource group name must be 3-63 alphanumeric, underscore, parentheses, hyphen, period (except at end), and Unicode characters that match the allowed characters."
                      }
                    ]
                  }
                }
              ]
            }
          ]
        }
      ]
    },
    "outputs": {
      "kind": "Subscription",
      "location": "[steps('basics').deploymentDetails.locationName]",
      "subscriptionId": "[steps('basics').deploymentDetails.subscriptionId]",
      "parameters": {
        "location": "[if(empty(steps('basics').deploymentDetails.locationName), '', steps('basics').deploymentDetails.locationName)]",
        "resourceGroupNameA": "[if(empty(steps('basics').resourceGroupSection.resourceGroupNameA), '', steps('basics').resourceGroupSection.resourceGroupNameA)]"
      }
    }
  }
}